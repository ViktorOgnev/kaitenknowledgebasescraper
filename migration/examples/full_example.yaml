# –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Kaiten DSL
# –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ DSL

version: 1.0

kaiten:
  domain: mycompany
  token: ${env:KAITEN_TOKEN}

# ============================================================================
# –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ü–û–õ–Ø
# ============================================================================
custom_properties:
  # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
  - name: –ö–ª–∏–µ–Ω—Ç
    type: catalog
    catalog_fields:
      - name: –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
        required: true
      - name: –ò–ù–ù
      - name: –ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ
      - name: –¢–µ–ª–µ—Ñ–æ–Ω
      - name: Email
      - name: –ì–æ—Ä–æ–¥
      - name: –°–∞–π—Ç

  # –ü—Ä–æ—Å—Ç–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
  - name: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–∞
    type: text

  # –ß–∏—Å–ª–æ
  - name: –°—É–º–º–∞ —Å–¥–µ–ª–∫–∏
    type: number

  # –î–∞—Ç–∞
  - name: –î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
    type: date

  # Email
  - name: Email –∫–ª–∏–µ–Ω—Ç–∞
    type: email

  # –¢–µ–ª–µ—Ñ–æ–Ω
  - name: –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞
    type: phone

  # –°–µ–ª–µ–∫—Ç (–≤—ã–±–æ—Ä –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è)
  - name: –ò—Å—Ç–æ—á–Ω–∏–∫
    type: select
    settings:
      options:
        - –°–∞–π—Ç
        - –†–µ–∫–ª–∞–º–∞
        - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

  # –ú—É–ª—å—Ç–∏—Å–µ–ª–µ–∫—Ç (–≤—ã–±–æ—Ä –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö)
  - name: –ò–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ —É—Å–ª—É–≥–∏
    type: multiselect
    settings:
      options:
        - –ö–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥
        - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
        - –ü–æ–¥–¥–µ—Ä–∂–∫–∞

  # –ß–µ–∫–±–æ–∫—Å
  - name: –î–æ–≥–æ–≤–æ—Ä –ø–æ–¥–ø–∏—Å–∞–Ω
    type: checkbox

  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  - name: –ö—É—Ä–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
    type: user

# ============================================================================
# –ú–ï–¢–ö–ò
# ============================================================================
tags:
  - name: –°—Ä–æ—á–Ω–æ
    color: "#FF0000"
  - name: –í–∞–∂–Ω–æ
    color: "#FFA500"
  - name: –ì–æ—Ä—è—á–∏–π –ª–∏–¥
    color: "#FF6600"
  - name: –•–æ–ª–æ–¥–Ω—ã–π –ª–∏–¥
    color: "#87CEEB"
  - name: B2B
    color: "#0066FF"
  - name: B2C
    color: "#00CC66"
  - name: –ö—Ä—É–ø–Ω–∞—è —Å–¥–µ–ª–∫–∞
    color: "#FFD700"

# ============================================================================
# –¢–ò–ü–´ –ö–ê–†–¢–û–ß–ï–ö
# ============================================================================
card_types:
  - name: –õ–∏–¥
    color: "#FFD700"
  - name: –í—Å—Ç—Ä–µ—á–∞
    color: "#9370DB"
  - name: –ó–≤–æ–Ω–æ–∫
    color: "#FF6347"
  - name: Email
    color: "#4169E1"
  - name: –ó–∞–¥–∞—á–∞
    color: "#20B2AA"

# ============================================================================
# –ü–†–û–°–¢–†–ê–ù–°–¢–í–ê –ò –î–û–°–ö–ò
# ============================================================================
spaces:
  # –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ CRM
  - name: CRM
    access: private
    boards:
      # –î–æ—Å–∫–∞: –í–æ—Ä–æ–Ω–∫–∞ –ª–∏–¥–æ–≤
      - name: –í–æ—Ä–æ–Ω–∫–∞ –ª–∏–¥–æ–≤
        description: –û—Å–Ω–æ–≤–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ –∫–æ–º–ø–∞–Ω–∏–∏
        columns:
          - name: –ù–æ–≤—ã–µ –ª–∏–¥—ã
            type: queue
            wip_limit: 20
          - name: –ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
            type: in_progress
            wip_limit: 15
          - name: –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ö–ü
            type: in_progress
            wip_limit: 10
          - name: –ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã
            type: in_progress
            wip_limit: 8
          - name: –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è
            type: in_progress
            wip_limit: 5
          - name: ‚úÖ –ó–∞–∫—Ä—ã—Ç–æ —É—Å–ø–µ—à–Ω–æ
            type: done
          - name: ‚ùå –û—Ç–∫–∞–∑
            type: done
        lanes:
          - name: –û–ª–µ–≥ –ò–≤–∞–Ω–æ–≤
          - name: –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞
          - name: –ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤

      # –î–æ—Å–∫–∞: –ë–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
      - name: –ë–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
        description: –ê–∫—Ç–∏–≤–Ω—ã–µ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã
        columns:
          - name: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ
            type: queue
          - name: –ê–∫—Ç–∏–≤–Ω—ã–µ
            type: in_progress
          - name: –ó–∞–∫—Ä—ã—Ç—ã
            type: done

  # –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –∑–∞–¥–∞—á
  - name: –ó–∞–¥–∞—á–∏ –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂
    access: private
    boards:
      - name: –†–∞–±–æ—á–∏–µ –∑–∞–¥–∞—á–∏
        description: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–∞–Ω–¥—ã
        columns:
          - name: –ë—ç–∫–ª–æ–≥
            type: queue
          - name: –°–µ–≥–æ–¥–Ω—è
            type: in_progress
          - name: –ì–æ—Ç–æ–≤–æ
            type: done

# ============================================================================
# –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò
# ============================================================================
automations:
  # –ê–≤—Ç–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ
  - name: –ê–≤—Ç–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ –≤–∑—è—Ç–∏–∏ –≤ —Ä–∞–±–æ—Ç—É
    space: CRM
    trigger: card_moved_to
    conditions:
      column: –ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
    actions:
      - type: set_owner
        value: event_author

  # –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —á–µ—Ä–µ–∑ 3 –¥–Ω—è
  - name: –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –ª–∏–¥–µ –≤ –ö–ü
    space: CRM
    trigger: time_based
    conditions:
      days_in_column: 3
      column: –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ö–ü
    actions:
      - type: add_tag
        value: –°—Ä–æ—á–Ω–æ
      - type: add_comment
        value: |
          ‚ö†Ô∏è –ü—Ä–æ—à–ª–æ 3 –¥–Ω—è —Å –º–æ–º–µ–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ö–ü.
          –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
          1. –ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É
          2. –£—Ç–æ—á–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è
          3. –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã

  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞
  - name: –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏
    space: CRM
    trigger: field_changed
    conditions:
      field: –î–æ–≥–æ–≤–æ—Ä –ø–æ–¥–ø–∏—Å–∞–Ω
      value: true
    actions:
      - type: move_card
        column: –ó–∞–∫—Ä—ã—Ç–æ —É—Å–ø–µ—à–Ω–æ
      - type: add_comment
        value: "üéâ –î–æ–≥–æ–≤–æ—Ä –ø–æ–¥–ø–∏—Å–∞–Ω! –°–¥–µ–ª–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞."

  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∏ –ø–æ —Å—É–º–º–µ —Å–¥–µ–ª–∫–∏
  - name: –ú–µ—Ç–∫–∞ –∫—Ä—É–ø–Ω–æ–π —Å–¥–µ–ª–∫–∏
    space: CRM
    trigger: field_changed
    conditions:
      field: –°—É–º–º–∞ —Å–¥–µ–ª–∫–∏
      operator: greater_than
      value: 500000
    actions:
      - type: add_tag
        value: –ö—Ä—É–ø–Ω–∞—è —Å–¥–µ–ª–∫–∞

# ============================================================================
# –ö–ê–†–¢–û–ß–ö–ò (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –¥–ª—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
# ============================================================================
cards:
  - title: –ü—Ä–∏–º–µ—Ä –ª–∏–¥–∞ - –û–û–û –†–æ–≥–∞ –∏ –∫–æ–ø—ã—Ç–∞
    board: CRM.–í–æ—Ä–æ–Ω–∫–∞ –ª–∏–¥–æ–≤
    column: –ù–æ–≤—ã–µ –ª–∏–¥—ã
    description: |
      –ö–æ–º–ø–∞–Ω–∏—è –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–∞ –≤ –Ω–∞—à–∏—Ö —É—Å–ª—É–≥–∞—Ö.
      –ó–∞–ø—Ä–æ—Å–∏–ª–∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.
    properties:
      –ò—Å—Ç–æ—á–Ω–∏–∫: –°–∞–π—Ç
      –°—É–º–º–∞ —Å–¥–µ–ª–∫–∏: 250000
      –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞: "+7 916 123-45-67"
      Email –∫–ª–∏–µ–Ω—Ç–∞: "info@rogaikopita.ru"

  - title: –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
    board: –ó–∞–¥–∞—á–∏ –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂.–†–∞–±–æ—á–∏–µ –∑–∞–¥–∞—á–∏
    column: –°–µ–≥–æ–¥–Ω—è
    description: –ü—Ä–æ–≤–µ—Å—Ç–∏ –≤—Å—Ç—Ä–µ—á—É —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º
    properties:
      –î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞: "2025-12-10"
